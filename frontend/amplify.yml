version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm install
    build:
      commands:
        # Set environment variables for Amplify build
        - export AMPLIFY_BUILD=true
        - export NEXT_PUBLIC_USE_API=true
        # Build the Next.js application
        - npm run build
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*

# Environment variables can be set in Amplify Console:
# - NEXT_PUBLIC_API_URL: Your API Gateway URL
# - NEXT_PUBLIC_SITE_URL: Your production site URL
# - NEXT_PUBLIC_SITE_NAME: Site display name
# - NEXT_PUBLIC_ENABLE_DONATIONS: true/false
# - NEXT_PUBLIC_ENABLE_AUTH: true/false
